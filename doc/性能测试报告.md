# 性能测试报告
PDT是基于开源项目WDT编译生成适用于Windows环境的数据传输工具，利用多个TCP路径最大化提高两个系统之间传送文件的速率及效率。
PDT协议支持Windows及Windows Server操作系统。

## 测试目的
依据合同要求，本报告主要测试验证PDT在1Gbit/s网络中的性能。

## 测试方法与内容
### 测试方法
为测试PDT分别在1Gbit/s环境中的速度，本报告主要通过对比PDT以及FTP、Windows远程数据拷贝、以及PsCP四种方法的数据传输速率，
以测试合同要求网络中，PDT的平均传输速率与理想网络环境传输速率的百分比，以及相同环境下PDT与其他数据传输方法的性能比较。

### 测试内容
1. 测试1Gbit/s环境下，PDT、FTP、Windows远程数据拷贝、PsCP等四种方法，分别传输大文件、大量小文件、混合类型文件的数据传输性能。
2. 本测试报告共测试 `2种环境 * 4种工具 * 3类数据 * 2次/组` 共48项，测试性能取每组的两次平均值。

## 测试环境
### 软硬件环境
#### 硬件环境
 - 测试机器配置：Intel Xeon CPU E5-2650 (2处理器)，16GB内存
 - 网络环境配置：HP Ethernet 1GB 4-Port Adapter，CAT 6e 网线直连

#### 软件环境
 - 操作系统：Windows Server 2008 R2 Enterprise 64位
 - PDT：
 - FTP：服务端windows Server IIS FTP服务，客户端 Cygwin + LFTP Version 4.6.5，FileZilla 3.16.0
 - Windows远程数据拷贝：
 - PsCP：

### 测试数据
本报告中所有测试所使用数据通过`dd`生成，生成脚本如下：
``` shell
PDT_TEST_DATA_DIR=/tmp/pdt-test/data
## 我们也可以使用`head -c`来生成数据
# 生成大小为4GB的随机内容的文件共16个
for file in `seq 1 16`; do
  dd if=/dev/urandom of=${PDT_TEST_DATA_DIR}/large/4GB.${file}.dd bs=64M count=64
done

# 生成1MB到1GB大小(整数MB)的文件，数据大小总量为64GB
tag=1
leftSize=65536
while [ "$leftSize" -gt "0" ]; do
  thisGenerated=$RANDOM
  thisGenerated=`expr "$thisGenerated" % "1024"`
  if [ "$thisGenerated" -eq "0" ]; then
    continue;
  fi
  if [ "$thisGenerated" -gt "$leftSize" ]; then
    thisGenerated=$leftSize
  fi
  echo dd if=/dev/urandom of=${PDT_TEST_DATA_DIR}/mixed/${tag}.${thisGenerated}.dd bs=1M count=$thisGenerated
  leftSize=`expr "$leftSize" - "$thisGenerated"`
  tag=`expr "$tag" + "1"`
done

# 生成1MB到10MB大小(整数MB)的文件，数据大小总量为64GB
tag=1
leftSize=65536
while [ "$leftSize" -gt "0" ]; do
  thisGenerated=$RANDOM
  thisGenerated=`expr "$thisGenerated" % "10"`
  if [ "$thisGenerated" -eq "0" ]; then
    continue;
  fi
  if [ "$thisGenerated" -gt "$leftSize" ]; then
    thisGenerated=$leftSize
  fi
  echo dd if=/dev/urandom of=${PDT_TEST_DATA_DIR}/small/${tag}.${thisGenerated}.dd bs=1M count=$thisGenerated
  leftSize=`expr "$leftSize" - "$thisGenerated"`
  tag=`expr "$tag" + "1"`
done
```

## 测试结果与分析
### 测试命令
- 接收端：wdt.exe -directory RECEIVE_DIR -run_as_daemon=true -ipv4
- 发送端：wdt.exe -directory SEND_DATA_DIR -destination REVEIVER_IP -transfer_id xxxxxxxx
- SEND_DATA_DIR目录下包含一次测试需要传输的数据
- transfer_id后参数由接收端命令生成
### 测试结果
### 结果分析
